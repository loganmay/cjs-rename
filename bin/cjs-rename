#!/usr/bin/env node
// vi:syntax=javascript

var program = require('commander');
var Rename = require('../index');
var package = require('../package.json');

program
  .version(package.version)
  .command('*')
  .description('cjs-rename [from] [to] [source...]')
  .action(command);

program.parse(process.argv);

// Show help if no args
if (! program.args.length) {
  console.log(program.help());
}

function command (from, to, source) {

  var rename = new Rename({
    to: to,
    from: from,
    folder: source
  });

  rename.run(function (err, changes) {

    if (! changes.length) {
      return console.log('No changes made');
    }

    console.log('Renaming:');

    for (var i = 0, len = changes.length; i < len; i++) {
      var change = changes[i];
      console.log('-', change.path, 'fixed', change.count, 'require()s');
    }

  });

};
